[
  {
    "id": "snip-001",
    "title": "Power Fx: Check business hours",
    "language": "power-fx",
    "category": "conditions",
    "description": "Check if current time is within business hours (9 AM - 5 PM, Mon-Fri)",
    "code": "If(\n  And(\n    Weekday(Now()) >= 2,\n    Weekday(Now()) <= 6,\n    Hour(Now()) >= 9,\n    Hour(Now()) < 17\n  ),\n  \"within_hours\",\n  \"outside_hours\"\n)",
    "explanation": "Weekday() returns 1=Sunday, 7=Saturday. Hour() returns 0-23. Checks Mon-Fri (2-6) and 9:00-16:59.",
    "use_case": "Route conversations differently during and after business hours",
    "tags": ["power-fx", "conditions", "business-hours"],
    "difficulty": "intermediate"
  },
  {
    "id": "snip-002",
    "title": "Power Fx: Format currency",
    "language": "power-fx",
    "category": "formatting",
    "description": "Format a number as US currency",
    "code": "Text(Topic.Amount, \"$#,##0.00\")",
    "explanation": "Text() formats numbers. Format string adds dollar sign, thousands separator, two decimals.",
    "use_case": "Display prices or totals in user-friendly format",
    "tags": ["power-fx", "formatting", "currency"],
    "difficulty": "beginner"
  },
  {
    "id": "snip-003",
    "title": "Power Fx: Validate email format",
    "language": "power-fx",
    "category": "validation",
    "description": "Basic check if string looks like a valid email",
    "code": "If(\n  And(\n    !IsBlank(Topic.Email),\n    CountRows(Split(Topic.Email, \"@\")) = 2,\n    CountRows(Split(Last(Split(Topic.Email, \"@\")).Value, \".\")) >= 2\n  ),\n  true,\n  false\n)",
    "explanation": "Checks: not blank, has exactly one @, has at least one dot after @.",
    "use_case": "Validate email before using in API calls",
    "tags": ["power-fx", "validation", "email"],
    "difficulty": "intermediate"
  },
  {
    "id": "snip-004",
    "title": "Power Fx: Parse JSON response",
    "language": "power-fx",
    "category": "http",
    "description": "Extract values from HTTP JSON response",
    "code": "Set(Topic.CustomerName, Text(Topic.HttpResponse.customer.name));\nSet(Topic.CustomerEmail, Text(Topic.HttpResponse.customer.email));\nSet(Topic.OrderCount, Value(Topic.HttpResponse.orderCount));",
    "explanation": "Use dot notation for JSON. Text() for strings, Value() for numbers.",
    "use_case": "Extract data from API responses",
    "tags": ["power-fx", "http", "json"],
    "difficulty": "intermediate"
  },
  {
    "id": "snip-005",
    "title": "Power Fx: Build comma-separated list",
    "language": "power-fx",
    "category": "strings",
    "description": "Convert table/array to comma-separated string",
    "code": "Concat(Topic.ItemsTable, Name, \", \")",
    "explanation": "Concat() joins table rows. Second param is column, third is separator.",
    "use_case": "Display multiple items in readable format",
    "tags": ["power-fx", "strings", "formatting"],
    "difficulty": "beginner"
  },
  {
    "id": "snip-006",
    "title": "Power Fx: Truncate long text",
    "language": "power-fx",
    "category": "strings",
    "description": "Truncate string to maximum length with ellipsis",
    "code": "If(\n  Len(Topic.LongText) > 100,\n  Left(Topic.LongText, 100) & \"...\",\n  Topic.LongText\n)",
    "explanation": "Checks length, truncates with Left() if too long, adds ellipsis.",
    "use_case": "Truncate long descriptions for display",
    "tags": ["power-fx", "strings", "truncate"],
    "difficulty": "beginner"
  },
  {
    "id": "snip-007",
    "title": "Power Fx: Date comparison",
    "language": "power-fx",
    "category": "dates",
    "description": "Check if date is past, today, or future",
    "code": "Switch(\n  true,\n  Topic.TargetDate < Today(), \"past\",\n  Topic.TargetDate = Today(), \"today\",\n  Topic.TargetDate > Today(), \"future\"\n)",
    "explanation": "Switch with true evaluates conditions. Today() returns date without time.",
    "use_case": "Branch logic based on due dates or expiration",
    "tags": ["power-fx", "dates", "conditions"],
    "difficulty": "intermediate"
  },
  {
    "id": "snip-008",
    "title": "Power Fx: Days between dates",
    "language": "power-fx",
    "category": "dates",
    "description": "Calculate number of days between two dates",
    "code": "DateDiff(Topic.StartDate, Topic.EndDate, TimeUnit.Days)",
    "explanation": "DateDiff returns difference in specified unit. Also: Hours, Minutes, Months.",
    "use_case": "Calculate duration or time until deadline",
    "tags": ["power-fx", "dates", "calculations"],
    "difficulty": "beginner"
  },
  {
    "id": "snip-009",
    "title": "Power Fx: Handle null safely",
    "language": "power-fx",
    "category": "validation",
    "description": "Safely handle blank/null values with fallback",
    "code": "Coalesce(Topic.UserInput, \"default value\")",
    "explanation": "Coalesce returns first non-blank value. Prevents errors from missing data.",
    "use_case": "Provide fallbacks for missing input or API responses",
    "tags": ["power-fx", "validation", "null-handling"],
    "difficulty": "beginner"
  },
  {
    "id": "snip-010",
    "title": "Power Fx: Generate reference ID",
    "language": "power-fx",
    "category": "utilities",
    "description": "Generate a random reference number",
    "code": "Concatenate(\"REF-\", Text(Today(), \"yyyymmdd\"), \"-\", Text(RandBetween(1000, 9999)))",
    "explanation": "Combines prefix, date, and random number. Example: REF-20250215-4827",
    "use_case": "Generate ticket numbers or reference codes",
    "tags": ["power-fx", "utilities", "random"],
    "difficulty": "beginner"
  },
  {
    "id": "snip-011",
    "title": "Power Fx: Case-insensitive compare",
    "language": "power-fx",
    "category": "strings",
    "description": "Compare strings ignoring case",
    "code": "Lower(Topic.UserInput) = Lower(\"expected value\")",
    "explanation": "Convert both sides to lowercase before comparing.",
    "use_case": "Match user input regardless of capitalization",
    "tags": ["power-fx", "strings", "comparison"],
    "difficulty": "beginner"
  },
  {
    "id": "snip-012",
    "title": "JSON: HTTP request body",
    "language": "json",
    "category": "http",
    "description": "Template for HTTP POST request body",
    "code": "{\n  \"userId\": \"{Topic.UserId}\",\n  \"action\": \"createTicket\",\n  \"data\": {\n    \"title\": \"{Topic.Title}\",\n    \"description\": \"{Topic.Description}\",\n    \"priority\": \"{Topic.Priority}\"\n  },\n  \"source\": \"CopilotStudio\"\n}",
    "explanation": "Use curly braces to insert Power Fx variables.",
    "use_case": "Structure API requests with dynamic data",
    "tags": ["json", "http", "templates"],
    "difficulty": "intermediate"
  },
  {
    "id": "snip-013",
    "title": "YAML: Topic with condition",
    "language": "yaml",
    "category": "topics",
    "description": "Topic template with condition branching",
    "code": "kind: AdaptiveDialog\nbeginDialog:\n  kind: OnRecognizedIntent\n  intent:\n    triggerQueries:\n      - Check order\n      - Order status\n  actions:\n    - kind: Question\n      id: q_orderId\n      prompt: What's your order number?\n      variable: Topic.OrderId\n    - kind: ConditionGroup\n      conditions:\n        - id: found\n          condition: =!IsBlank(Topic.Result)\n          actions:\n            - kind: SendMessage\n              message: \"Order status: {Topic.Result.status}\"",
    "explanation": "Shows question node and condition branching in YAML format.",
    "use_case": "Reference template for conditional flows",
    "tags": ["yaml", "topics", "conditions"],
    "difficulty": "intermediate"
  },
  {
    "id": "snip-014",
    "title": "Power Fx: Round numbers",
    "language": "power-fx",
    "category": "math",
    "description": "Round to specified decimal places",
    "code": "Round(Topic.Price, 2)",
    "explanation": "Round() takes value and decimal places. Also: RoundUp(), RoundDown().",
    "use_case": "Clean up calculated values for display",
    "tags": ["power-fx", "math", "rounding"],
    "difficulty": "beginner"
  },
  {
    "id": "snip-015",
    "title": "Power Fx: Check if list contains item",
    "language": "power-fx",
    "category": "collections",
    "description": "Check if a value exists in a list",
    "code": "If(\n  Topic.UserRole in [\"Admin\", \"Manager\", \"Supervisor\"],\n  \"Has elevated access\",\n  \"Standard user\"\n)",
    "explanation": "The 'in' operator checks if value exists in array.",
    "use_case": "Check user permissions or validate input against allowed values",
    "tags": ["power-fx", "collections", "validation"],
    "difficulty": "beginner"
  }
]
